name: UnitTest

on: [push, pull_request]


jobs:
  build:
    runs-on: ubuntu-22.04

    steps:
    - name: Checkout code
      uses: actions/checkout@v4

    - name: Install Googletest 1.16.0
      run: |
        git clone -q https://github.com/google/googletest.git
        cd googletest
        git checkout v1.16.0
        mkdir build
        cd build
        cmake ..
        make -j$(nproc)
        sudo make install

    - name: Install Benchmark 1.9.1
      run: |
        git clone -q https://github.com/google/benchmark.git
        cd benchmark
        git checkout v1.9.1
        mkdir build
        cd build
        cmake -DCMAKE_BUILD_TYPE=Release -DBENCHMARK_ENABLE_GTEST_TESTS=OFF -DBENCHMARK_DOWNLOAD_DEPENDENCIES=OFF .. 
        make -j$(nproc)
        sudo make install

    - name: Test
      run: |
        ls -l
        cd optimus
        echo $(pwd)
        g++ -v
        make ts_sum_test

